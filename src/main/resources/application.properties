spring.application.name=auth-backend

#server.address=api.authcenter.madhusudan.space
server.address=0.0.0.0
server.port=${PORT:8080}

# DB connection
spring.datasource.url=${DB_JDBC_URL}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# Hikari pool (keep small for Supabase free)
spring.datasource.hikari.maximum-pool-size=${DB_POOL_SIZE:5}
spring.datasource.hikari.minimum-idle=${DB_MIN_IDLE:2}
spring.datasource.hikari.idle-timeout=${DB_IDLE_TIMEOUT_MS:60000}
spring.datasource.hikari.connection-timeout=${DB_CONN_TIMEOUT_MS:30000}
spring.datasource.hikari.keepaliveTime=${DB_KEEPALIVE_MS:300000}
spring.datasource.hikari.data-source-properties.preferQueryMode=simple
spring.datasource.hikari.data-source-properties.prepareThreshold=0
spring.datasource.hikari.validation-timeout=${DB_VALIDATION_TIMEOUT_MS:5000}

# JPA/Hibernate Configuration
spring.jpa.hibernate.ddl-auto=${JPA_DDL_AUTO:update}
spring.jpa.show-sql=${JPA_SHOW_SQL:false}
spring.jpa.properties.hibernate.default_schema=${DB_DEFAULT_SCHEMA:auth_schema}
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect

# Actuator health endpoints (for Render health checks)
management.endpoints.web.exposure.include=health,info
management.endpoint.health.probes.enabled=true
management.health.db.enabled=true

# Startup resilience: don't fail fast if DB is temporarily unavailable
spring.datasource.hikari.initializationFailTimeout=0

# Log pattern
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# Log file configuration
logging.file.name=logs/application.log
logging.file.max-size=10MB
logging.file.max-history=7
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# Logging configuration
logging.level.root=${LOG_LEVEL_ROOT:INFO}
logging.level.com.authcenter=${LOG_LEVEL_APP:INFO}
logging.level.org.springframework.mail=DEBUG
logging.level.org.apache.commons.mail=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.org.springframework.jdbc.core.JdbcTemplate=DEBUG
logging.level.org.springframework.orm.jpa=DEBUG
logging.level.org.springframework.transaction=DEBUG

#allowed cros origins
authcenter.cors.allowed-origins=${CORS_ALLOWED_ORIGINS:}

#allowed Redirect URIs (for after login / MFA)
authcenter.redirect.allowed-uris=${REDIRECT_ALLOWED_URIS:}

#JWT
jwt.secret=${JWT_SECRET:}
# 15 minutes
jwt.access.expiration.ms=${JWT_ACCESS_EXP_MS:900000}
# 7 days
jwt.refresh.expiration.ms=${JWT_REFRESH_EXP_MS:604800000}

#reCaptcha
recaptcha.secret=${RECAPTCHA_SECRET:}

# OTP Configuration
authcenter.otp.secret=${OTP_SECRET:}
authcenter.otp.length=${OTP_LENGTH:6}
authcenter.otp.max.attempts=${OTP_MAX_ATTEMPTS:5}
authcenter.otp.expiration.minutes=${OTP_EXP_MIN:5}
authcenter.otp.rate.limit.minutes=${OTP_RATE_LIMIT_MIN:1}

# Brevo SMTP Configuration
spring.mail.host=${MAIL_HOST:}
spring.mail.port=${MAIL_PORT:587}
spring.mail.username=${MAIL_USERNAME:}
spring.mail.password=${MAIL_PASSWORD:}

# SMTP Properties
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000

# Super admin
authcenter.super.admin.email=${SUPER_ADMIN_EMAIL:}

# Base frontend url for super admin dashboard
authcenter.approval.link.base=${APPROVAL_LINK_BASE:}

# mail service details
mail.from.address=${MAIL_FROM_ADDRESS:}
mail.from.name=${MAIL_FROM_NAME:AuthCenter}
mail.replyto=${MAIL_REPLY_TO:}
mail.unsubscribe.url=${MAIL_UNSUBSCRIBE_URL:}

#Swagger Security
authcenter.swagger.username=authceter
authcenter.swagger.password=authceter@swager

#Swagger
springdoc.swagger-ui.disable-swagger-default-url=true
springdoc.swagger-ui.display-operation-id=false
